library(stringr)
library(ggrepel)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
library(stringr)
library(ggrepel)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
### 5. furthur-edit txt file ###
file_directory <- "/Users/coellearth/Desktop/Mammary_Gland_Diet_Project/2DEG/DEG_in_Cell_Type"
file_list <- list.files(path = file_directory, pattern = "\\.txt$", full.names = TRUE)
process_file <- function(file_path) {
df <- read.delim(file_path, header = TRUE, sep = "\t")
if("avg_log2FC" %in% colnames(df)) {
df <- df %>%
mutate(`un/down_regulated_(ND/HFD)` = case_when(
avg_log2FC > 0 ~ "up-regulated",
avg_log2FC < 0 ~ "down-regulated",
TRUE ~ "same"
))
} else {
warning(paste("The file", file_path, "does not contain 'avg_log2FC' column. Skipping..."))
}
return(df)
}
processed_dataframes <- lapply(file_list, process_file)
for(i in seq_along(file_list)) {
write_path <- file_list[i]
write.table(processed_dataframes[[i]], file = write_path, sep = "\t", row.names = FALSE, quote = FALSE)
}
### 5. combine files ###
combined_df <- bind_rows(processed_dataframes)
head(combined_df)
View(combined_df)
write.table(combined_df, file = "/Users/coellearth/Desktop/Mammary_Gland_Diet_Project/2DEG/DEG_in_Cell_Type/combinedfile", sep = "\t", row.names = FALSE, quote = FALSE)
library(stringr)
library(ggrepel)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
### 5. furthur-edit txt file ###
file_directory <- "/Users/coellearth/Desktop/Mammary_Gland_Diet_Project/2DEG/DEG_in_Cell_Type"
file_list <- list.files(path = file_directory, pattern = "\\.txt$", full.names = TRUE)
process_file <- function(file_path) {
df <- read.delim(file_path, header = TRUE, sep = "\t")
file_name <- tools::file_path_sans_ext(basename(file_path))
df <- df %>%
select(-`un/down_regulated_(ND/HFD)`)
if("avg_log2FC" %in% colnames(df)) {
df <- df %>%
mutate(`un/down_regulated_(ND/HFD)` = case_when(
avg_log2FC > 0 ~ "up-regulated",
avg_log2FC < 0 ~ "down-regulated",
TRUE ~ "same"
))
} else {
warning(paste("The file", file_path, "does not contain 'avg_log2FC' column. Skipping..."))
}
df <- df %>%
mutate(cell_type = file_name) %>%
select(cell_type, everything())
return(df)
}
processed_dataframes <- lapply(file_list, process_file)
file_list <- list.files(path = file_directory, pattern = "\\.txt$", full.names = TRUE)
process_file <- function(file_path) {
df <- read.delim(file_path, header = TRUE, sep = "\t")
if("avg_log2FC" %in% colnames(df)) {
df <- df %>%
mutate(`un/down_regulated_(ND/HFD)` = case_when(
avg_log2FC > 0 ~ "up-regulated",
avg_log2FC < 0 ~ "down-regulated",
TRUE ~ "same"
))
} else {
warning(paste("The file", file_path, "does not contain 'avg_log2FC' column. Skipping..."))
}
df <- df %>%
mutate(cell_type = file_name) %>%
select(cell_type, everything())
return(df)
}
processed_dataframes <- lapply(file_list, process_file)
process_file <- function(file_path) {
df <- read.delim(file_path, header = TRUE, sep = "\t")
file_name <- tools::file_path_sans_ext(basename(file_path))
if("avg_log2FC" %in% colnames(df)) {
df <- df %>%
mutate(`un/down_regulated_(ND/HFD)` = case_when(
avg_log2FC > 0 ~ "up-regulated",
avg_log2FC < 0 ~ "down-regulated",
TRUE ~ "same"
))
} else {
warning(paste("The file", file_path, "does not contain 'avg_log2FC' column. Skipping..."))
}
df <- df %>%
mutate(cell_type = file_name) %>%
select(cell_type, everything())
return(df)
}
processed_dataframes <- lapply(file_list, process_file)
for(i in seq_along(file_list)) {
write_path <- file_list[i]
write.table(processed_dataframes[[i]], file = write_path, sep = "\t", row.names = FALSE, quote = FALSE)
}
### 5. combine files ###
combined_df <- bind_rows(processed_dataframes)
View(combined_df)
write.table(combined_df, file = "/Users/coellearth/Desktop/Mammary_Gland_Diet_Project/2DEG/DEG_in_Cell_Type/combinedfile", sep = "\t", row.names = FALSE, quote = FALSE)
devtools::install_github("Coolgenome/iTALK", build_vignettes = TRUE)
library(iTALK)
devtools::install_github("Coolgenome/iTALK", build_vignettes = TRUE)
library(iTALK)
devtools::install_github("Coolgenome/iTALK", build_vignettes = TRUE)
BiocManager::install("edgeR")
BiocManager::install("scde")
devtools::install_github("Coolgenome/iTALK", build_vignettes = TRUE)
library(iTALK)
if(!require(devtools)) install.packages("devtools");
devtools::install_github("Coolgenome/iTALK", build_vignettes = TRUE)
devtools::install_github("Coolgenome/iTALK")
install.packages("Cairo")
